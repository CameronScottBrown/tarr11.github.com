
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Keep your ASP.NET MVC projects organized with partial classes - Douglas Tarr</title>
  <meta name="author" content="Douglas Tarr">

  
  <meta name="description" content="I use partial classes for controller and service classes to keep my ASP.NET MVC projects more organized. The default behavior (file-per-controller) &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://douglastarr.com/keep-your-asp-dot-net-mvc-projects-more-organized-with-partial-classes">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Douglas Tarr" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-18064705-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Douglas Tarr</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:douglastarr.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/projects.html">Projects</a></li>
  <li><a href="/contact.html">Contact</a></li>
  <li><a href="/resume.html">Resume</a></li>
  <li><a href="/archives/">Blog Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Keep Your ASP.NET MVC Projects Organized With Partial Classes</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-01T10:57:00-08:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I use partial classes for controller and service classes to keep my ASP.NET MVC projects more organized.</p>

<h3>The default behavior (file-per-controller) creates large files with lots of methods</h3>

<p>I&rsquo;ve built many projects that use the standard Visual Studio csproj template, which creates a file per controller.  Over time, a controller may accumulate many methods (tens or even hundreds)</p>

<p>This makes these files difficult to read and navigate.
<img src="/images/messy-controller.png" alt="messy controller" /></p>

<h2>Controllers</h2>

<h3>Store ViewModels in the same file as controller methods</h3>

<p>ViewModels are coupled to a controller and a view.</p>

<div><script src='https://gist.github.com/7739637.js'></script>
<noscript><pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
namespace BetterMvc.Controllers.Home
{
    public partial class HomeController : ControllerBase
    {
        public ActionResult Index()
        {
            var result = svc.DoSomething(new Services.Master.DoSomethingRequest
            {
            });
            var vm = new IndexViewModel { };
            return View(vm);
        }
    }

    public class IndexViewModel
    {
        public string UserName {get;set;}

    }
}</code></pre></noscript></div>


<h2>WebAPI</h2>

<h3>Store GET/POST/DELETE/PUT methods in the different files</h3>

<p>When using WebAPI, you will have multiple methods that apply to the same resource, for saving, deleting, updating, etc.</p>

<p>Each of these methods will have a different view model and controller action.</p>

<p>Create a directory with the name of the controller, and create each WebAPI controller as a partial.</p>

<p>Store each WebAPI action in a separate file, along with it&rsquo;s associated ViewModel.</p>

<div><script src='https://gist.github.com/7752207.js'></script>
<noscript><pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Http;

namespace BetterMvc.Api.V1.User
{
    public class GetUser
    {
    [HttpGet]
    public GetUserViewModel Get()
        {
            return new GetUserViewModel();
        }
    }

    public class GetUserViewModel
    {
        public string Username { get; set; }
        public string ImageUrl { get; set; }

    }
}</code></pre></noscript></div>


<h2>Services</h2>

<h3>Store DTOs in the same file as service methods</h3>

<p>In a Request/Response pattern, DTOs are coupled to service methods.</p>

<p>By storing the request and response in the same file, it is easier to make changes.</p>

<h3>Store interface definitions in the same file as service methods</h3>

<p>If you use a Dependency Injection Framework (such as <a href="http://www.ninject.org">Ninject</a>), you will have an interface definition for each public service method.  This creates file navigation problems with a typical ASP.NET MVC project, since hitting F12 on a method call from a controller will land you on the interface definition, as opposed to the method implementation.</p>

<p>By putting the interface definition in the same file as the primary method definition, you can simply scroll down the page to implementation.  You can also use a tool like <a href="http://www.jetbrains.com/resharper/">ReSharper</a>, but I find that workflow to require more navigation than simply housing these files together.</p>

<div><script src='https://gist.github.com/7752306.js'></script>
<noscript><pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace BetterMvc.Services.Master
{
    public partial interface IMasterService
    {
        DoSomethingResult DoSomething(DoSomethingRequest request);
    }

    public partial class MasterService : IMasterService
    {
        public DoSomethingResult DoSomething(DoSomethingRequest request)
        {
            return new DoSomethingResult { SomeData = &quot;foo&quot; };
        }
    }

    public class DoSomethingResult : Result
    {
        public string SomeData { get; set; }

    }

    public class DoSomethingRequest : Request
    {
        public int Id { get; set; }

    }
}</code></pre></noscript></div>


<h2>Version Control and Code Review</h2>

<h3>Use shell commands to navigate files</h3>

<p>Shell commands (powershell, dos, bash) become much more powerful when your code is organized by granularly by files.</p>

<ul>
<li>Sort by alpha, date modified, size changes</li>
<li>Use git status / hg st to find which sections of code changed</li>
</ul>


<h3>Reduce Merge Conflicts by organizing files more granularly</h3>

<p>The bane of a developers existence is a merge conflict.   In common workflows, a team of developers often work on one feature of the code at a time, and teams try to make an effort not to work on the same &ldquo;area&rdquo;.</p>

<p>When different areas of code are combined into one file, merge conflicts arise.</p>

<p>In ASP.NET MVC, this means you may be working on a few controller method, views, and service methods to implement a new feature.</p>

<p>By reducing the size of files you are working on, and keeping them organized by subject, it is less likely that you will have conflicts with other developers.  Or, you may only have them in the .csproj file, where it is fairly trivial and safe to resolve.</p>

<h3>Make Code Reviews easier to Read</h3>

<p>If you use git or mercurial for source control, you will often do code reviews by reviewing a branch of code(ie., feature-branch), and comparing it to another branch (ie, develop).</p>

<p>When doing these comparisons, you will see a series of commits that are grouped by file.  If associated assets (DTOs or ViewModels) reside in the same file as the methods that they support, it is easier to review, since you don&rsquo;t have to jump around as much.</p>

<p>You can also quickly scan filenames to understand the subject of the change.</p>

<p><img src="/images/github-diff.png" alt="github diff" /></p>

<h3>Better MVC</h3>

<p>I am organizing these practices into a project on Github, humbly called <a href="https://github.com/tarr11/BetterMVC">BetterMVC</a>.</p>

<p>My goal is to make BetterMVC a lightweight project template that allows you to start new MVC projects in a clean way, and adopt some best practices along the way.  Right now, it is simply more of a reference.</p>

<p><a href="https://github.com/tarr11/BetterMVC">Fork BetterMVC Here</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Douglas Tarr</span></span>

      








  


<time datetime="2013-12-01T10:57:00-08:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/categories/aspnet/'>aspnet</a>, <a class='category' href='/categories/better-mvc/'>better-mvc</a>, <a class='category' href='/categories/csharp/'>csharp</a>, <a class='category' href='/categories/dev/'>dev</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://douglastarr.com/keep-your-asp-dot-net-mvc-projects-more-organized-with-partial-classes/" data-via="tarr11" data-counturl="http://douglastarr.com/keep-your-asp-dot-net-mvc-projects-more-organized-with-partial-classes/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/scratch-variables-and-lists-coding-class-week-5/" title="Previous Post: Scratch Variables and Lists - Coding Class Week 5">&laquo; Scratch Variables and Lists - Coding Class Week 5</a>
      
      
        <a class="basic-alignment right" href="/clones-and-variables-coding-class-week-6/" title="Next Post: Clones and variables - Coding Class Week 6">Clones and variables - Coding Class Week 6 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
        <div><img src="/images/profile.jpg"></div>
        <p>I'm a software developer who lives in Mill Valley, California, with my wife and 2 children.</p>
	<p>My wife J'Amy is a talented fashion designer who has launched a line of <a href="http://jamytarr.com">Women's Coats and Jackets</a>.  You should check it out.</p>

</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/mill-valley-fpv-drone-project/">Mill Valley FPV Drone Project</a>
      </li>
    
      <li class="post">
        <a href="/coveredca-and-anthem-problems/">CoveredCA and Anthem Problems</a>
      </li>
    
      <li class="post">
        <a href="/coveredca-and-anthem-problems/">Coveredca and Anthem Problems</a>
      </li>
    
      <li class="post">
        <a href="/working-on-our-scratch-game-week-7/">Working on Our Scratch Game - Week 7</a>
      </li>
    
      <li class="post">
        <a href="/clones-and-variables-coding-class-week-6/">Clones and Variables - Coding Class Week 6</a>
      </li>
    
  </ul>
</section>
<a class="twitter-timeline" href="https://twitter.com/tarr11" data-widget-id="389457673361428481">Tweets by @tarr11</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Douglas Tarr -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'douglastarr';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://douglastarr.com/keep-your-asp-dot-net-mvc-projects-more-organized-with-partial-classes/';
        var disqus_url = 'http://douglastarr.com/keep-your-asp-dot-net-mvc-projects-more-organized-with-partial-classes/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
